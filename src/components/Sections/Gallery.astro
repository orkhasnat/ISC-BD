---
import { Image } from "astro:assets";
// Import all gallery images using import.meta.glob (eager load for static build)
const images = Object.values(import.meta.glob<{ default: ImageMetadata }>("@/assets/gallery/*.webp", { eager: true }));

// Shuffle images for randomness
const shuffled = images
  .map((value) => ({ value, sort: Math.random() }))
  .sort((a, b) => a.sort - b.sort)
  .map(({ value }) => value);
---

<section id="gallery" class="py-24 bg-muted/20">
  <div class="container mx-auto px-4">
    <div class="text-center mb-16">
        <h2 class="text-3xl md:text-5xl font-heading font-bold text-foreground mb-4">Gallery</h2>
        <p class="text-muted-foreground">Moments from our journey.</p>
    </div>

    <div class="columns-1 md:columns-2 lg:columns-3 gap-6 space-y-6">
      {shuffled.slice(0, 15).map((img) => (
        <div class="break-inside-avoid overflow-hidden rounded-xl bg-muted">
           <Image 
            src={img.default} 
            alt="Gallery" 
            class="w-full h-auto object-cover hover:scale-105 transition-transform duration-500"
            width={600}
            loading="lazy"
           />
        </div>
      ))}
    </div>
    
    <div class="text-center mt-12">
        <p class="text-sm text-muted-foreground italic">Refreshing the page will show different random memories.</p>
    </div>
  </div>
</section>
